---
title: "Ris-k"
date: 2021-12-04T01:49:45-05:00
draft: true
author: me, of course
katex: true
markup: "mmark"
---

I have been playing a lot of Risk with my family recently and got to wondering what the chances of success are per battle. The internet says the following:

![alt text](/risk-prob.png)

What might it look like to generate these results on our own using simulated dice throws and battles? Because this is one of those toy problems that is quite math-y, let's use `k`, or [kona](https://github.com/kevinlawler/kona) to be precise. It will allow us to be terse almost to the point of having executable formulae that define our problem.     

Let's generate 50,000 simulated roles of three attackers vs two defenders, if the internet is correct we should see something close to `37%` for the attacker winning both, `33%` for going one-and-one and a `29%` chance of the attacker losing both solders. Here is the code we can use to do that:

```k
 n:50000.
 r1:{1+1 _draw 6}; r2:{a@>a:1+2 _draw 6}; r3:{2#a@>a:1+3 _draw 6}
 {(#x)%n}'={c@>c:+/'x}(r3'!n){0<x-y}'r2'!n

 \ the result I got this run  => 0.37436 0.3346 0.29104
 ```

 

Looks like the internet never lies, our results are within a few tenths of a percent across the board.

I will go over the "how" in terms of the code further on, but briefly, this is what each line says (for more on the syntax see ...) 

`n:50000.` defines the number of runs as a floating point number.

`r1:{1+1 _draw 6}; ... r3:...` defines the functions roll 1, roll 2 and roll 3 as returning a list of sorted integers that represent the each of the dice thrown per player. Because at most the defender can only engage two soldiers, the roll 3 function takes the 2 highest for the fight and is only ever called by the attacker.

`{(#x)%n}'={c@>c:+/'x}(r3'!n){0<x-y}'r2'!n` in words would read (from left to right) as "return the percent of the total `n` for each group `x` generated by grouping the sorted list that was generated by applying the function `0<x-y` to the lists representing `n` rolls of the attacking dice `(r3'!n)` and `n` rolls of the defending dice `r2'!n`."

<!--

```k
 r1:{1+1 _draw 6}; r2:{a@>a:1+2 _draw 6}; r3:{2#a@>a:1+3 _draw 6}
 d:(r3;r2;r1)
 gr:{(d@*& (x+1) > 3 2 1)[]}	
 c:{0<((#b)#gr x) - b:gr x&2&y}
 {{(x>0) & y>0}. x}{{(x-+/0=a; y-+/1=a:c[x;y])}. x}\(10;10)

 n:50000.
 {(#x)%n}'={c@>c:+/'x}(r3'!n){0<x-y}'r2'!n


```


| Item         | Price     | # In stock |
|--------------|-----------|------------|
| Juicy Apples | 1.99      | *7*        |
| Bananas      | **1.89**  | 5234       |

r1:{{1+1 _draw 6}'!x}
r2:{{a@>a:1+2 _draw 6}'!x}
r3:{2#'{a@>a:1+3 _draw 6}'!x}

{(#x) % n}'={c@>c:+/'x} (r3 n){0<x-y}'r2 n
{(#x) % n}'={c@>c:+/'x} (1#'r3 n){0<x-y}'r1 n

-->